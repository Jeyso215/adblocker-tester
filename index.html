<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Ultimate Privacy Test Suite</title>
    <style>
        /* Previous styles remain unchanged */
        /* Added new styles for advanced tests */
        .advanced-test {
            border-left: 4px solid #2196F3;
            margin: 15px 0;
            padding: 10px;
        }
    </style>
</head>
<body>
    <!-- Previous HTML structure remains -->
    <!-- Enhanced Cryptojacking Section -->
    <div class="test-category">
        <h2>‚õèÔ∏è Cryptojacking</h2>
        <div class="test-item" id="cryptojacking">
            <div class="status-dot"></div>
            <div>
                <h3>Browser Mining</h3>
                <p>Testing CoinHive, Crypto-Loot, and Webmine</p>
            </div>
        </div>
    </div>

    <!-- Enhanced Fingerprinting Section -->
    <div class="test-category">
        <h2>üñêÔ∏è Advanced Fingerprinting</h2>

        <div class="advanced-test" id="webgl-fp">
            <h4>WebGL Fingerprinting</h4>
            <p>Rendering complex WebGL patterns</p>
        </div>

        <div class="advanced-test" id="font-fp">
            <h4>Font Enumeration</h4>
            <p>Detecting installed system fonts</p>
        </div>

        <div class="advanced-test" id="canvas-fp">
            <h4>Canvas Fingerprinting</h4>
            <p>Drawing hidden canvas elements</p>
        </div>

        <div class="advanced-test" id="audio-fp">
            <h4>AudioContext Fingerprinting</h4>
            <p>Analyzing audio signal processing</p>
        </div>

        <div class="advanced-test" id="battery-fp">
            <h4>Battery API</h4>
            <p>Checking battery status access</p>
        </div>
    </div>

    <script>
        // Updated tests configuration
        const tests = {
            // Previous tests remain
            'cryptojacking': [
                'https://coinhive.com/lib/miner.js',
                'https://cryptoloot.com/lib/miner.js',
                'https://webmine.pro/lib/miner.js'
            ],
            'fingerprinting': [
                'webgl-render',
                'font-enumeration',
                'canvas-data',
                'audio-context',
                'battery-api'
            ]
        };

        // Enhanced test runner
        async function runTest(type, url) {
            if(url.startsWith('webgl')) {
                return testWebGL();
            }
            if(url.startsWith('font')) {
                return testFontEnumeration();
            }
            if(url.startsWith('canvas')) {
                return testCanvasFingerprint();
            }
            if(url.startsWith('audio')) {
                return testAudioContext();
            }
            if(url.startsWith('battery')) {
                return testBatteryAPI();
            }
            // Existing tests remain
        }

        // New fingerprinting tests
        function testWebGL() {
            try {
                const canvas = document.createElement('canvas');
                const gl = canvas.getContext('webgl');
                const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
                return !(gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL).includes('Google SwiftShader'));
            } catch(e) {
                return true;
            }
        }

        function testFontEnumeration() {
            const testFonts = ['Impact', 'Courier New', 'UnknownFont'];
            const widths = [];
            const el = document.createElement('div');
            el.style.position = 'absolute';
            el.style.left = '-9999px';

            document.body.appendChild(el);

            testFonts.forEach(font => {
                el.style.fontFamily = font;
                widths.push(el.offsetWidth);
            });

            document.body.removeChild(el);

            // If all widths are same, font enumeration is blocked
            return new Set(widths).size === 1;
        }

        function testAudioContext() {
            try {
                const context = new AudioContext();
                const oscillator = context.createOscillator();
                oscillator.start();
                return false;
            } catch(e) {
                return true;
            }
        }

        function testBatteryAPI() {
            return !('getBattery' in navigator);
        }

        // Enhanced cryptojacking test
        function testCryptojacking() {
            const tests = [
                () => typeof CoinHive === 'undefined',
                () => typeof ClientJS === 'undefined',
                () => !document.querySelector('script[src*="cryptoloot"]')
            ];

            return tests.every(test => test());
        }

        // Update initialization
        function initializeTests() {
            // Create WebGL fingerprint test
            const webglCanvas = document.createElement('canvas');
            webglCanvas.width = 1;
            webglCanvas.height = 1;
            document.body.appendChild(webglCanvas);

            // Create font enumeration test element
            const fontTest = document.createElement('div');
            fontTest.style.cssText = 'position:absolute;left:-9999px;';
            document.body.appendChild(fontTest);

            // Initialize crypto mining tests
            const minerScript = document.createElement('script');
            minerScript.src = 'https://coinhive.com/lib/miner.js';
            document.head.appendChild(minerScript);
        }

        // Start enhanced tests
        initializeTests();
        runAllTests();
    </script>
</body>
</html>
